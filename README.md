# EtherCATパケット解析ビューア

## 概要
このツールは、PCAPNGファイルからEtherCATパケットを読み込み、解析して表示するためのビューアです。EtherCATプロトコルの詳細な情報を視覚的に確認することができます。

## 機能
- PCAPNGファイルからのEtherCATパケット読み込み
- 事前フィルタリング機能（Wireshark表示フィルタ形式）
- 後処理フィルタリング機能（表示データの絞り込み）
- パケット詳細情報の表示（基本情報、EtherCAT情報、16進データ）
- CSVおよびExcelへのエクスポート機能
- ET2000タイムスタンプの解析
- パケット間の時間差表示

## 必要条件
- Python 3.6以上
- 必要パッケージ：
  - pandas
  - pyshark
  - matplotlib
  - tkinter

## インストール方法
1. 必要なパッケージをインストールします：
```
pip install pandas pyshark matplotlib
```

2. tkinterがインストールされていない場合は、システムに応じてインストールしてください。

## 使用方法
1. 以下のコマンドでアプリケーションを起動します：
```
python 16_improved_filter_stats.py
```

2. 「PCAPNGファイルを選択」ボタンをクリックして解析するファイルを選択します。
3. 必要に応じてフィルタを設定し、パケット情報を確認します。

## ライセンス
このソフトウェアは内部使用を目的としています。

## 特定条件のスループット計算
以下の条件に一致するパケットのスループットを自動計算します：
```
((eth.addr == 02:10:b6:18:35:30) && !(ecat.cnd == 0x04)) && !(ecat.cmd == 0x05)
```

## ファイル構成
- `16_improved_filter_stats.py`: メインプログラム
- `config.py`: 設定ファイル
- `data_utils.py`: データ処理ユーティリティ
- `error_handler.py`: エラー処理モジュール
- `ui_settings.json`: UI設定ファイル

## 注意事項
- 大量のパケットを含むPCAPNGファイルを開く場合は、処理に時間がかかることがあります
- 特定条件のスループット計算は、該当するパケットが存在する場合のみ表示されます 